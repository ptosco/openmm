const real eleBuf = 0.005f;
float3 exceptionParams = PARAMS[index];
real3 delta = make_real3(pos2.x-pos1.x, pos2.y-pos1.y, pos2.z-pos1.z);
real r2 = delta.x*delta.x + delta.y*delta.y + delta.z*delta.z;
real r = SQRT(r2);
real rBuf = r + eleBuf;
real rBufInv = RECIP(rBuf);
real invR = RECIP(r);
real r6 = r2*r2*r2;
real r7 = r6*r;
real sigma7 = exceptionParams.y*exceptionParams.y;
sigma7 = sigma7*sigma7*sigma7*exceptionParams.y;
real rho = r7 + sigma7*0.12f;
real invRho = RECIP(rho);
real tau = 1.07f/(r + 0.07f*exceptionParams.y);
real tau7 = tau*tau*tau;
tau7 = tau7*tau7*tau;
real dTau = tau/1.07f;
real tmp = sigma7*invRho;
real gTau = exceptionParams.z*tau7*r6*1.12f*tmp*tmp;
real vdwEnergy = exceptionParams.z*sigma7*tau7*((sigma7*1.12f*invRho)-2.0f);
real dEdR = 7.0f*(dTau*vdwEnergy+gTau);
dEdR *= invR;
real coulEnergy = exceptionParams.x*rBufInv;
dEdR += coulEnergy*rBufInv*invR;
energy += vdwEnergy + coulEnergy;
delta *= dEdR;
real3 force1 = -delta;
real3 force2 = delta;
